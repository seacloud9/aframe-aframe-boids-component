!function(t){function i(o){if(a[o])return a[o].exports;var s=a[o]={exports:{},id:o,loaded:!1};return t[o].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}var a={};return i.m=t,i.c=a,i.p="",i(0)}([function(t,i,a){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("aframe-boids",{schema:{color:{default:778835},cameras:{default:[]}},multiple:!1,init:function(){this.el;this.data.SCREEN_WIDTH=window.innerWidth,this.data.SCREEN_HEIGHT=window.innerHeight,this.data.scene=this.el.sceneEl.object3D,this.data.randomCamera=this.randomCamera.bind(this);var t=a(2),i=a(1);this.data.boids=[],this.data.birdsEl=[],this.data.birds=[];for(var o=0;o<200;o++){var s=document.createElement("a-entity");this.data.boid=this.data.boids[o]=new t,this.data.boid.position.x=400*Math.random()-200,this.data.boid.position.y=400*Math.random()-200,this.data.boid.position.z=400*Math.random()-200,this.data.boid.velocity.x=2*Math.random()-1,this.data.boid.velocity.y=2*Math.random()-1,this.data.boid.velocity.z=2*Math.random()-1,this.data.boid.setAvoidWalls(!0),this.data.boid.setWorldSize(500,500,400),this.data.bird=this.data.birds[o]=new THREE.Mesh(new i,new THREE.MeshBasicMaterial({color:this.data.color,side:THREE.DoubleSide}));var e=document.createElement("a-entity");e.setAttribute("id","boidCam"+o),e.setAttribute("camera","active: false"),this.data.birds[o].add(e.object3D),this.data.cameras.push(e),this.data.bird.phase=Math.floor(62.83*Math.random()),s.object3D.add(this.data.bird),this.data.birdsEl.push(s),this.el.sceneEl.appendChild(s),s.appendChild(e)}this.el.sceneEl.addEventListener("render-target-loaded",function(){this.data.render=this.el.sceneEl.renderer}.bind(this)),document.querySelector("a-scene").addEventListener("camera-set-active",function(t){t.detail.cameraEl.classList.add("active-camera")})},randomSelection:function(t){return t[Math.floor(Math.random()*t.length)]},randomCamera:function(){this.cameraSwap.call(this,this.randomSelection.call(this,this.data.cameras))},cameraSwap:function(t){t.setAttribute("camera","active",!0)},update:function(t){},remove:function(){},tick:function(t){for(var i=0,a=this.data.birds.length;i<a;i++)this.data.boid=this.data.boids[i],this.data.boid.run(this.data.boids),this.data.bird=this.data.birds[i],this.data.bird.position.copy(this.data.boids[i].position),this.data.color=this.data.bird.material.color,this.data.bird.rotation.y=Math.atan2(-this.data.boid.velocity.z,this.data.boid.velocity.x),this.data.bird.rotation.z=Math.asin(this.data.boid.velocity.y/this.data.boid.velocity.length()),this.data.birdsEl[i].setAttribute("position",this.data.bird.position.x+" "+this.data.bird.position.y+" "+this.data.bird.position.z),this.data.birdsEl[i].setAttribute("rotation",this.data.bird.rotation.x+" "+this.data.bird.rotation.y+" "+this.data.bird.rotation.z),this.data.bird.phase=(this.data.bird.phase+(Math.max(0,this.data.bird.rotation.z)+.1))%62.83,this.data.bird.geometry.vertices[5].y=this.data.bird.geometry.vertices[4].y=5*Math.sin(this.data.bird.phase)},pause:function(){},play:function(){}})},function(t,i){var a=function(){function t(t,i,o){a.vertices.push(new THREE.Vector3(t,i,o))}function i(t,i,o){a.faces.push(new THREE.Face3(t,i,o))}var a=this;THREE.Geometry.call(this),t(5,0,0),t(-5,-2,1),t(-5,0,0),t(-5,-2,-1),t(0,2,-6),t(0,2,6),t(2,0,0),t(-3,0,0),i(0,2,1),i(4,7,6),i(5,6,7),this.computeFaceNormals()};a.prototype=Object.create(THREE.Geometry.prototype),a.prototype.constructor=a,t.exports=a},function(t,i){var a=function(){var t,i,a=new THREE.Vector3,o=500,s=500,e=200,n=100,d=4,r=.1,h=!1;this.position=new THREE.Vector3,this.velocity=new THREE.Vector3,t=new THREE.Vector3,this.setGoal=function(t){i=t},this.setAvoidWalls=function(t){h=t},this.setWorldSize=function(t,i,a){o=t,s=i,e=a},this.run=function(i){h&&(a.set(-o,this.position.y,this.position.z),a=this.avoid(a),a.multiplyScalar(5),t.add(a),a.set(o,this.position.y,this.position.z),a=this.avoid(a),a.multiplyScalar(5),t.add(a),a.set(this.position.x,-s,this.position.z),a=this.avoid(a),a.multiplyScalar(5),t.add(a),a.set(this.position.x,s,this.position.z),a=this.avoid(a),a.multiplyScalar(5),t.add(a),a.set(this.position.x,this.position.y,-e),a=this.avoid(a),a.multiplyScalar(5),t.add(a),a.set(this.position.x,this.position.y,e),a=this.avoid(a),a.multiplyScalar(5),t.add(a)),Math.random()>.5&&this.flock(i),this.move()},this.flock=function(a){i&&t.add(this.reach(i,.005)),t.add(this.alignment(a)),t.add(this.cohesion(a)),t.add(this.separation(a))},this.move=function(){this.velocity.add(t);var i=this.velocity.length();i>d&&this.velocity.divideScalar(i/d),this.position.add(this.velocity),t.set(0,0,0)},this.checkBounds=function(){this.position.x>o&&(this.position.x=-o),this.position.x<-o&&(this.position.x=o),this.position.y>s&&(this.position.y=-s),this.position.y<-s&&(this.position.y=s),this.position.z>e&&(this.position.z=-e),this.position.z<-e&&(this.position.z=e)},this.avoid=function(t){var i=new THREE.Vector3;return i.copy(this.position),i.sub(t),i.multiplyScalar(1/this.position.distanceToSquared(t)),i},this.repulse=function(i){var a=this.position.distanceTo(i);if(a<150){var o=new THREE.Vector3;o.subVectors(this.position,i),o.multiplyScalar(.5/a),t.add(o)}},this.reach=function(t,i){var a=new THREE.Vector3;return a.subVectors(t,this.position),a.multiplyScalar(i),a},this.alignment=function(t){for(var i,a=new THREE.Vector3,o=0,s=0,e=t.length;s<e;s++)Math.random()>.6||(i=t[s],distance=i.position.distanceTo(this.position),distance>0&&distance<=n&&(a.add(i.velocity),o++));if(o>0){a.divideScalar(o);var d=a.length();d>r&&a.divideScalar(d/r)}return a},this.cohesion=function(t){for(var i,a,o=new THREE.Vector3,s=new THREE.Vector3,e=0,d=0,h=t.length;d<h;d++)Math.random()>.6||(i=t[d],a=i.position.distanceTo(this.position),a>0&&a<=n&&(o.add(i.position),e++));e>0&&o.divideScalar(e),s.subVectors(o,this.position);var c=s.length();return c>r&&s.divideScalar(c/r),s},this.separation=function(t){for(var i,a,o=new THREE.Vector3,s=new THREE.Vector3,e=0,d=t.length;e<d;e++)Math.random()>.6||(i=t[e],a=i.position.distanceTo(this.position),a>0&&a<=n&&(s.subVectors(this.position,i.position),s.normalize(),s.divideScalar(a),o.add(s)));return o}};t.exports=a}]);