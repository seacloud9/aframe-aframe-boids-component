!function(t){function i(e){if(a[e])return a[e].exports;var o=a[e]={exports:{},id:e,loaded:!1};return t[e].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}var a={};return i.m=t,i.c=a,i.p="",i(0)}([function(t,i,a){a(1);if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("aframe-boids",{schema:{color:{default:778835},cameras:{default:[]}},multiple:!1,init:function(){this.el;this.data.SCREEN_WIDTH=window.innerWidth,this.data.SCREEN_HEIGHT=window.innerHeight,this.data.scene=this.el.sceneEl.object3D,this.data.randomCamera=this.randomCamera.bind(this);var t=a(3),i=a(2);this.data.boids=[],this.data.birdsEl=[],this.data.birds=[],this.data.tubesEl=[];for(var e=0;e<200;e++){var o=document.createElement("a-entity");this.data.boid=this.data.boids[e]=new t,this.data.boid.position.x=400*Math.random()-200,this.data.boid.position.y=400*Math.random()-200,this.data.boid.position.z=400*Math.random()-200,this.data.boid.velocity.x=2*Math.random()-1,this.data.boid.velocity.y=2*Math.random()-1,this.data.boid.velocity.z=2*Math.random()-1,this.data.boid.setAvoidWalls(!0),this.data.boid.setWorldSize(500,500,400),this.data.bird=this.data.birds[e]=new THREE.Mesh(new i,new THREE.MeshBasicMaterial({color:this.data.color,side:THREE.DoubleSide}));var s=document.createElement("a-entity");s.setAttribute("id","boidCam"+e),s.setAttribute("camera","active: false"),this.data.birds[e].add(s.object3D),this.data.cameras.push(s),this.data.bird.phase=Math.floor(62.83*Math.random());var n=document.createElement("a-tube");n.setAttribute("material","color: red"),n.setAttribute("path",this.data.boid.position.x+" "+this.data.boid.position.y+" "+this.data.boid.position.z),this.data.tubesEl.push(n),o.appendChild(n),o.object3D.add(this.data.bird),this.data.birdsEl.push(o),this.el.sceneEl.appendChild(o),o.appendChild(s)}this.el.sceneEl.addEventListener("render-target-loaded",function(){this.data.render=this.el.sceneEl.renderer}.bind(this)),document.querySelector("a-scene").addEventListener("camera-set-active",function(t){t.detail.cameraEl.classList.add("active-camera")})},randomSelection:function(t){return t[Math.floor(Math.random()*t.length)]},randomCamera:function(){this.cameraSwap.call(this,this.randomSelection.call(this,this.data.cameras))},cameraSwap:function(t){t.setAttribute("camera","active",!0)},update:function(t){},remove:function(){},tick:function(t){for(var i=0,a=this.data.birds.length;i<a;i++)this.data.boid=this.data.boids[i],this.data.boid.run(this.data.boids),this.data.bird=this.data.birds[i],this.data.bird.position.copy(this.data.boids[i].position),this.data.color=this.data.bird.material.color,this.data.bird.rotation.y=Math.atan2(-this.data.boid.velocity.z,this.data.boid.velocity.x),this.data.bird.rotation.z=Math.asin(this.data.boid.velocity.y/this.data.boid.velocity.length()),this.data.birdsEl[i].setAttribute("position",this.data.bird.position.x+" "+this.data.bird.position.y+" "+this.data.bird.position.z),this.data.birdsEl[i].setAttribute("rotation",this.data.bird.rotation.x+" "+this.data.bird.rotation.y+" "+this.data.bird.rotation.z),this.data.tubesEl[i].setAttribute("path",this.data.tubesEl[i].getAttribute("path")+","+this.data.bird.position.x+" "+this.data.bird.position.y+" "+this.data.bird.position.z),this.data.bird.phase=(this.data.bird.phase+(Math.max(0,this.data.bird.rotation.z)+.1))%62.83,this.data.bird.geometry.vertices[5].y=this.data.bird.geometry.vertices[4].y=5*Math.sin(this.data.bird.phase)},pause:function(){},play:function(){}})},function(t,i){var a=t.exports.Primitive={defaultComponents:{tube:{}},mappings:{path:"tube.path",segments:"tube.segments",radius:"tube.radius",radialSegments:"tube.radialSegments",closed:"tube.closed"}},e=t.exports.Component={schema:{path:{default:[]},segments:{default:64},radius:{default:1},radialSegments:{default:8},closed:{default:!1}},init:function(){var t=this.el,i=this.data,a=t.components.material;if(!i.path.length)return void console.error("[a-tube] `path` property expected but not found.");var e=new THREE.CatmullRomCurve3(i.path.map(function(t){return t=t.split(" "),new THREE.Vector3(Number(t[0]),Number(t[1]),Number(t[2]))})),o=new THREE.TubeGeometry(e,i.segments,i.radius,i.radialSegments,i.closed);a||(a={},a.material=new THREE.MeshPhongMaterial),this.mesh=new THREE.Mesh(o,a.material),this.el.setObject3D("mesh",this.mesh)},remove:function(){this.mesh&&this.el.removeObject3D("mesh")}};t.exports.registerAll=function(){var t=!1;return function(i){t||(i=i||window.AFRAME,i.registerComponent("tube",e),i.registerPrimitive("a-tube",a),t=!0)}}()},function(t,i){var a=function(){function t(t,i,e){a.vertices.push(new THREE.Vector3(t,i,e))}function i(t,i,e){a.faces.push(new THREE.Face3(t,i,e))}var a=this;THREE.Geometry.call(this),t(5,0,0),t(-5,-2,1),t(-5,0,0),t(-5,-2,-1),t(0,2,-6),t(0,2,6),t(2,0,0),t(-3,0,0),i(0,2,1),i(4,7,6),i(5,6,7),this.computeFaceNormals()};a.prototype=Object.create(THREE.Geometry.prototype),a.prototype.constructor=a,t.exports=a},function(t,i){var a=function(){var t,i,a=new THREE.Vector3,e=500,o=500,s=200,n=100,d=4,r=.1,h=!1;this.position=new THREE.Vector3,this.velocity=new THREE.Vector3,t=new THREE.Vector3,this.setGoal=function(t){i=t},this.setAvoidWalls=function(t){h=t},this.setWorldSize=function(t,i,a){e=t,o=i,s=a},this.run=function(i){h&&(a.set(-e,this.position.y,this.position.z),a=this.avoid(a),a.multiplyScalar(5),t.add(a),a.set(e,this.position.y,this.position.z),a=this.avoid(a),a.multiplyScalar(5),t.add(a),a.set(this.position.x,-o,this.position.z),a=this.avoid(a),a.multiplyScalar(5),t.add(a),a.set(this.position.x,o,this.position.z),a=this.avoid(a),a.multiplyScalar(5),t.add(a),a.set(this.position.x,this.position.y,-s),a=this.avoid(a),a.multiplyScalar(5),t.add(a),a.set(this.position.x,this.position.y,s),a=this.avoid(a),a.multiplyScalar(5),t.add(a)),Math.random()>.5&&this.flock(i),this.move()},this.flock=function(a){i&&t.add(this.reach(i,.005)),t.add(this.alignment(a)),t.add(this.cohesion(a)),t.add(this.separation(a))},this.move=function(){this.velocity.add(t);var i=this.velocity.length();i>d&&this.velocity.divideScalar(i/d),this.position.add(this.velocity),t.set(0,0,0)},this.checkBounds=function(){this.position.x>e&&(this.position.x=-e),this.position.x<-e&&(this.position.x=e),this.position.y>o&&(this.position.y=-o),this.position.y<-o&&(this.position.y=o),this.position.z>s&&(this.position.z=-s),this.position.z<-s&&(this.position.z=s)},this.avoid=function(t){var i=new THREE.Vector3;return i.copy(this.position),i.sub(t),i.multiplyScalar(1/this.position.distanceToSquared(t)),i},this.repulse=function(i){var a=this.position.distanceTo(i);if(a<150){var e=new THREE.Vector3;e.subVectors(this.position,i),e.multiplyScalar(.5/a),t.add(e)}},this.reach=function(t,i){var a=new THREE.Vector3;return a.subVectors(t,this.position),a.multiplyScalar(i),a},this.alignment=function(t){for(var i,a=new THREE.Vector3,e=0,o=0,s=t.length;o<s;o++)Math.random()>.6||(i=t[o],distance=i.position.distanceTo(this.position),distance>0&&distance<=n&&(a.add(i.velocity),e++));if(e>0){a.divideScalar(e);var d=a.length();d>r&&a.divideScalar(d/r)}return a},this.cohesion=function(t){for(var i,a,e=new THREE.Vector3,o=new THREE.Vector3,s=0,d=0,h=t.length;d<h;d++)Math.random()>.6||(i=t[d],a=i.position.distanceTo(this.position),a>0&&a<=n&&(e.add(i.position),s++));s>0&&e.divideScalar(s),o.subVectors(e,this.position);var c=o.length();return c>r&&o.divideScalar(c/r),o},this.separation=function(t){for(var i,a,e=new THREE.Vector3,o=new THREE.Vector3,s=0,d=t.length;s<d;s++)Math.random()>.6||(i=t[s],a=i.position.distanceTo(this.position),a>0&&a<=n&&(o.subVectors(this.position,i.position),o.normalize(),o.divideScalar(a),e.add(o)));return e}};t.exports=a}]);